{-# LANGUAGE QuasiQuotes #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE OverloadedStrings #-}

import Data.Char (toLower)
import Data.List (sort)
import Text.Blaze.Html.Renderer.String (renderHtml)
import Text.Hamlet.XML (xml)

import qualified Data.Text as Text

main :: IO ()
main = do
  name <- getLine
  -- (name :: Int) <- readLn
  putStrLn $
    renderHtml
      [xml|
<!DOCTYPE html>
<html lang="ja">
  <head><meta content="IE=edge" http-equiv="X-UA-Compatible"><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Kucipong Webpack App</title><link href="/static/adminUser-fe44cd06f7016b3d157c.css" rel="stylesheet"></head>
  <body class="wrapper" id="main">
    <header class="header">
      <div class="home showMenu">
        <input class="showMenu_checkbox" id="adminHeaderShowMenu" type="checkbox">
        <label class="showMenu_label" for="adminHeaderShowMenu">
          <img class="showMenu_label-image" src="/static/hamburger-3c29c5f60e6806f305801f4e9c7ca1c2.svg">
        </label>
      </div>
      <div>
        <p>Hello, my name is #{Text.pack name} and I am #{Text.pack $ show age}.</p>
        <p>
          Let's do some funny stuff with my name: #
          <b>#{Text.pack $ sort $ map toLower name}</b>
        </p>
        <p>
          Oh, and in 5 years I'll be #{Text.pack $ show ((+) 5 age)} years old.
        </p>
      </div>
    </header>
  </body>
</html>
|]
  where
    age = 34 :: Int
